

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pulse Width Modulation &mdash; Wall-E Docs  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LED BLINK" href="../1_led_blink/README.html" />
    <link rel="prev" title="How bot balance itself?" href="../7_self_balancing/README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Wall-E Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../7_self_balancing/README.html">How bot balance itself?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_self_balancing/README.html#formula-for-calculation-of-pitch-correction">Formula for calculation of pitch correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_self_balancing/README.html#algorithm">ALGORITHM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../7_self_balancing/README.html#description-of-the-functions">Description of the functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Pulse Width Modulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#key-terms">Key Terms:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#duty-cycle">Duty Cycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="#period">Period</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#pwm-voltage-regulation">PWM: Voltage Regulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#led-dimmer">LED Dimmer</a></li>
<li class="toctree-l1"><a class="reference internal" href="#pwm-for-speed-control">PWM for Speed Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="#motor-drivers">Motor Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="#description-of-functions-used">Description of Functions Used</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#esp-err-t-enable-motor-driver-a-int-mode"><code class="docutils literal notranslate"><span class="pre">esp_err_t</span> <span class="pre">enable_motor_driver_a(int</span> <span class="pre">mode)</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#esp-err-t-enable-motor-driver-b-int-mode"><code class="docutils literal notranslate"><span class="pre">esp_err_t</span> <span class="pre">enable_motor_driver_b(int</span> <span class="pre">mode)</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#esp-err-t-set-motor-speed-int-motor-id-int-direction-float-duty-cycle"><code class="docutils literal notranslate"><span class="pre">esp_err_t</span> <span class="pre">set_motor_speed(int</span> <span class="pre">motor_id,</span> <span class="pre">int</span> <span class="pre">direction,</span> <span class="pre">float</span> <span class="pre">duty_cycle)</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#void-vtaskdelay-const-ticktype-t-xtickstodelay"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">vTaskDelay(const</span> <span class="pre">TickType_t</span> <span class="pre">xTicksToDelay)</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#static-basetype-t-xtaskcreate-taskfunction-t-pvtaskcode-const-char-const-pcname-uint32-t-usstackdepth-void-const-pvparameters-ubasetype-t-uxpriority-taskhandle-t-const-pvcreatedtask"><code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">BaseType_t</span> <span class="pre">xTaskCreate(TaskFunction_t</span> <span class="pre">pvTaskCode,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">*const</span> <span class="pre">pcName,</span> <span class="pre">uint32_t</span> <span class="pre">usStackDepth,</span> <span class="pre">void</span> <span class="pre">*const</span> <span class="pre">pvParameters,</span> <span class="pre">UBaseType_t</span> <span class="pre">uxPriority,</span> <span class="pre">TaskHandle_t</span> <span class="pre">*const</span> <span class="pre">pvCreatedTask)</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../1_led_blink/README.html">LED BLINK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4_switch_controlled_motor_normal/README.html"> </a></li>
<li class="toctree-l1"><a class="reference internal" href="../2_LSA/README.html">LSA - Light Sensor Array</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_MPU/README.html">MPU6050 Sensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/7_self_balancing/README.html">How bot balance itself?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/7_self_balancing/README.html#formula-for-calculation-of-pitch-correction">Formula for calculation of pitch correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/7_self_balancing/README.html#algorithm">ALGORITHM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/7_self_balancing/README.html#description-of-the-functions">Description of the functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/5_PWM/README.html">Pulse Width Modulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/5_PWM/README.html#pwm-voltage-regulation">PWM: Voltage Regulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/5_PWM/README.html#led-dimmer">LED Dimmer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/5_PWM/README.html#pwm-for-speed-control">PWM for Speed Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/5_PWM/README.html#motor-drivers">Motor Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/5_PWM/README.html#description-of-functions-used">Description of Functions Used</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/README.html">Table of Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/README.html#about-the-workshop">About the Workshop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/README.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/README.html#examples">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/README.html#resources">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/README.html#contribution">Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/README.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/1_led_blink/README.html">LED BLINK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/4_switch_controlled_motor_normal/README.html"> </a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/2_LSA/README.html">LSA - Light Sensor Array</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docs/source/3_MPU/README.html">MPU6050 Sensor</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Wall-E Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Pulse Width Modulation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/5_PWM/README.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pulse-width-modulation">
<h1>Pulse Width Modulation<a class="headerlink" href="#pulse-width-modulation" title="Link to this heading"></a></h1>
<p>Pulse Width Modulation (PWM) is a square wave signal in which the duration of the high and low phases can be adjusted. It’s commonly used in embedded systems for controlling power to devices such as LEDs and motors.</p>
<p>A typical PWM signal looks like this:</p>
<p><img alt="PWM waveform" src="https://www.javatpoint.com/embeddedsystem/images/pwm-avr-microcontroller1.png" /></p>
<section id="key-terms">
<h2>Key Terms:<a class="headerlink" href="#key-terms" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>ON-Time:</strong> Duration when the signal is high.</p></li>
<li><p><strong>OFF-Time:</strong> Duration when the signal is low.</p></li>
<li><p><strong>Duty Cycle:</strong> Percentage of the total period during which the signal is high.</p></li>
<li><p><strong>Period:</strong> Total time duration of one complete cycle (ON-Time + OFF-Time).</p></li>
</ul>
</section>
<section id="duty-cycle">
<h2>Duty Cycle<a class="headerlink" href="#duty-cycle" title="Link to this heading"></a></h2>
<p>The duty cycle indicates how much of the time the PWM signal stays in the HIGH state during a cycle. It is calculated using:</p>
<p><img alt="Duty Cycle Formula" src="https://www.javatpoint.com/embeddedsystem/images/pwm-avr-microcontroller2.png" /></p>
<p><img alt="Duty Cycle Examples" src="https://upload.wikimedia.org/wikipedia/commons/b/b8/Duty_Cycle_Examples.png" /></p>
</section>
<section id="period">
<h2>Period<a class="headerlink" href="#period" title="Link to this heading"></a></h2>
<p>The period of a PWM signal is the sum of ON-Time (Ton) and OFF-Time (Toff):</p>
<p><img alt="Period Formula" src="https://www.javatpoint.com/embeddedsystem/images/pwm-avr-microcontroller3.png" /></p>
</section>
</section>
<section id="pwm-voltage-regulation">
<h1>PWM: Voltage Regulation<a class="headerlink" href="#pwm-voltage-regulation" title="Link to this heading"></a></h1>
<p>By changing the duty cycle of a PWM signal, we can effectively regulate output voltage. This is widely used in:</p>
<ul class="simple">
<li><p>Audio signal modulation</p></li>
<li><p>LED dimming</p></li>
<li><p>Analog signal generation</p></li>
<li><p>Switching regulators</p></li>
<li><p>Motor speed control</p></li>
</ul>
<p>PWM voltage regulation works on the principle of averaging the PWM signal. The output voltage is proportional to the duty cycle:</p>
<p><img alt="Voltage Regulation Formula" src="https://www.javatpoint.com/embeddedsystem/images/pwm-avr-microcontroller4.png" /></p>
</section>
<section id="led-dimmer">
<h1>LED Dimmer<a class="headerlink" href="#led-dimmer" title="Link to this heading"></a></h1>
<p>PWM is an efficient technique to control LED brightness with minimal energy loss. Instead of wasting energy via resistors, brightness is modulated by varying the ON/OFF duration of the signal.</p>
<ul class="simple">
<li><p><strong>More ON-time → Brighter LED</strong></p></li>
<li><p><strong>More OFF-time → Dimmer LED</strong></p></li>
</ul>
<p><img alt="LED PWM Dimmer" src="https://exploreembedded.com/wiki/images/5/54/0_LPC1768_PWM.gif" /><br />
<img alt="LED Fade Effect" src="https://makeabilitylab.github.io/physcomp/esp32/assets/movies/Huzzah32_Fade-optimized.gif" /></p>
</section>
<section id="pwm-for-speed-control">
<h1>PWM for Speed Control<a class="headerlink" href="#pwm-for-speed-control" title="Link to this heading"></a></h1>
<p>PWM can be used to control the speed of DC motors by modulating the average voltage applied to the motor:</p>
<ul class="simple">
<li><p><strong>Higher Duty Cycle → Higher Average Voltage → Faster Motor Speed</strong></p></li>
<li><p><strong>Lower Duty Cycle → Lower Average Voltage → Slower Motor Speed</strong></p></li>
</ul>
<p>The motor doesn’t respond instantaneously to voltage; hence, a properly tuned PWM signal gives you finer control over speed.</p>
<p>A PWM controller switches power ON/OFF in rapid pulses. By adjusting the pulse width (duration of ON-Time), we effectively vary motor speed.</p>
</section>
<section id="motor-drivers">
<h1>Motor Drivers<a class="headerlink" href="#motor-drivers" title="Link to this heading"></a></h1>
<p>Motor drivers act as power amplifiers. They take low-current signals from a controller and convert them into higher-current signals required to drive motors.</p>
<p>The driver used in this workshop is <strong>TB6612FNG</strong> — a dual H-Bridge motor driver IC ideal for DC motors.</p>
</section>
<section id="description-of-functions-used">
<h1>Description of Functions Used<a class="headerlink" href="#description-of-functions-used" title="Link to this heading"></a></h1>
<section id="esp-err-t-enable-motor-driver-a-int-mode">
<h2><code class="docutils literal notranslate"><span class="pre">esp_err_t</span> <span class="pre">enable_motor_driver_a(int</span> <span class="pre">mode)</span></code><a class="headerlink" href="#esp-err-t-enable-motor-driver-a-int-mode" title="Link to this heading"></a></h2>
<p><strong>Description:</strong> Initializes Motor Driver A in either Parallel or Normal mode.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> = Parallel Mode</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> = Normal Mode</p></li>
</ul>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ESP_OK</span></code> if initialization successful</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ESP_ERR_INVALID_ARG</span></code> if an invalid mode is passed</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="esp-err-t-enable-motor-driver-b-int-mode">
<h2><code class="docutils literal notranslate"><span class="pre">esp_err_t</span> <span class="pre">enable_motor_driver_b(int</span> <span class="pre">mode)</span></code><a class="headerlink" href="#esp-err-t-enable-motor-driver-b-int-mode" title="Link to this heading"></a></h2>
<p><strong>Description:</strong> Initializes Motor Driver B in either Parallel or Normal mode.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> = Parallel Mode</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> = Normal Mode</p></li>
</ul>
</li>
</ul>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ESP_OK</span></code> if initialization successful</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ESP_ERR_INVALID_ARG</span></code> if an invalid mode is passed</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="esp-err-t-set-motor-speed-int-motor-id-int-direction-float-duty-cycle">
<h2><code class="docutils literal notranslate"><span class="pre">esp_err_t</span> <span class="pre">set_motor_speed(int</span> <span class="pre">motor_id,</span> <span class="pre">int</span> <span class="pre">direction,</span> <span class="pre">float</span> <span class="pre">duty_cycle)</span></code><a class="headerlink" href="#esp-err-t-set-motor-speed-int-motor-id-int-direction-float-duty-cycle" title="Link to this heading"></a></h2>
<p><strong>Description:</strong> Sets the speed and direction of the motor.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">motor_id</span></code>: Use one of the following: <code class="docutils literal notranslate"><span class="pre">MOTOR_A_0</span></code>, <code class="docutils literal notranslate"><span class="pre">MOTOR_A_1</span></code>, <code class="docutils literal notranslate"><span class="pre">MOTOR_B_0</span></code>, <code class="docutils literal notranslate"><span class="pre">MOTOR_B_1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">direction</span></code>: Use one of the following:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">MOTOR_FORWARD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MOTOR_BACKWARD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MOTOR_STOP</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">duty_cycle</span></code>: Duty cycle to be applied via PWM</p></li>
</ul>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ESP_OK</span></code> on success</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ESP_FAIL</span></code> on error</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="void-vtaskdelay-const-ticktype-t-xtickstodelay">
<h2><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">vTaskDelay(const</span> <span class="pre">TickType_t</span> <span class="pre">xTicksToDelay)</span></code><a class="headerlink" href="#void-vtaskdelay-const-ticktype-t-xtickstodelay" title="Link to this heading"></a></h2>
<p><strong>Description:</strong> Delays a task for a specified number of ticks. You can convert real-time delay using <code class="docutils literal notranslate"><span class="pre">portTICK_PERIOD_MS</span></code>.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xTicksToDelay</span></code>: Number of ticks to delay execution.</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="static-basetype-t-xtaskcreate-taskfunction-t-pvtaskcode-const-char-const-pcname-uint32-t-usstackdepth-void-const-pvparameters-ubasetype-t-uxpriority-taskhandle-t-const-pvcreatedtask">
<h2><code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">BaseType_t</span> <span class="pre">xTaskCreate(TaskFunction_t</span> <span class="pre">pvTaskCode,</span> <span class="pre">const</span> <span class="pre">char</span> <span class="pre">*const</span> <span class="pre">pcName,</span> <span class="pre">uint32_t</span> <span class="pre">usStackDepth,</span> <span class="pre">void</span> <span class="pre">*const</span> <span class="pre">pvParameters,</span> <span class="pre">UBaseType_t</span> <span class="pre">uxPriority,</span> <span class="pre">TaskHandle_t</span> <span class="pre">*const</span> <span class="pre">pvCreatedTask)</span></code><a class="headerlink" href="#static-basetype-t-xtaskcreate-taskfunction-t-pvtaskcode-const-char-const-pcname-uint32-t-usstackdepth-void-const-pvparameters-ubasetype-t-uxpriority-taskhandle-t-const-pvcreatedtask" title="Link to this heading"></a></h2>
<p><strong>Description:</strong> Creates a new FreeRTOS task.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pvTaskCode</span></code>: Function pointer to the task logic (must not return)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pcName</span></code>: Descriptive name (max length defined by <code class="docutils literal notranslate"><span class="pre">configMAX_TASK_NAME_LEN</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">usStackDepth</span></code>: Stack size in bytes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvParameters</span></code>: Pointer to parameters passed to the task</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uxPriority</span></code>: Priority of the task (add <code class="docutils literal notranslate"><span class="pre">portPRIVILEGE_BIT</span></code> for privileged tasks)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvCreatedTask</span></code>: Pointer to store the handle of the created task</p></li>
</ul>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pdPASS</span></code> on success</p></li>
<li><p>Error code from <code class="docutils literal notranslate"><span class="pre">projdefs.h</span></code> otherwise</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../7_self_balancing/README.html" class="btn btn-neutral float-left" title="How bot balance itself?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../1_led_blink/README.html" class="btn btn-neutral float-right" title="LED BLINK" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>